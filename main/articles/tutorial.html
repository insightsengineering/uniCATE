<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Using uniCATE • uniCATE</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Using uniCATE">
<meta property="og:description" content="uniCATE">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-125641273-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-125641273-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">uniCATE</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.4.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/tutorial.html">Using uniCATE</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<!-- start dropdown for versions --> <li class="nav-item dropdown">
        <a href="#" class="nav-link dropdown-toggle"
          data-bs-toggle="dropdown" role="button"
          aria-expanded="false" aria-haspopup="true"
          id="dropdown-versions">Versions</a> <div class="dropdown-menu" aria-labelledby="dropdown-versions"> <a class="dropdown-item" data-toggle="tooltip" title="" href="https://insightsengineering.github.io/uniCATE/main">main</a> </div></li>
<!-- end dropdown for versions -->
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/insightsengineering/uniCATE" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Using uniCATE</h1>
                        <h4 data-toc-skip class="author"><a href="https://pboileau.ca" class="external-link">Philippe Boileau</a></h4>
            
            <h4 data-toc-skip class="date">2023-03-01</h4>
      
      
      <div class="hidden name"><code>tutorial.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h2>
<p>Predictive biomarkers are biometric measurements that subdivide
patient populations into groups which draw differing benefits from a
given treatment. These biomarkers therefore play an important role in
precision medicine: as indicators of treatment effect modification, they
can inform patient treatment decisions. Predictive biomarkers may also
be used for drug target discovery, leading to an improved understanding
of novel medications’ functioning.</p>
<p>The discovery of predictive biomarkers through statistical techniques
has, to date, largely been a byproduct of treatment rule estimation. As
implied by its name, this tasks consists of learning which treatment
would most benefit a patient given their characteristics. These
characteristics could include, but are not limited to, potentially
predictive biomarkers. When interpretable statistical learning methods
are used to estimate these rules, biomarkers found to be “important”
might be declared predictive. For example, estimation methods based on
regularized linear regression might define a biomarker as predictive if
its treatment interaction coefficient estimate is non-zero <span class="citation">(Tian et al. 2014)</span>.</p>
<p>While this approach to predictive biomarker discovery works well in
traditional asymptotic settings, it is not so when the number of
biomarkers is similar to or larger than the number of patients in a
study. These methods offer no guarantee of false positive rate control
<span class="citation">(Tian et al. 2014; Chen et al. 2017)</span>,
which can have severe consequences in practice. The inclusion of false
positive biomarkers in diagnostic assays decreases their clinical
utility, and already limited resources are wasted on biological
validation experiments of duds for drug target discovery purposes.
Patient outcomes are ultimately negatively affected.</p>
<p>We proposed in recent work a variable importance parameter that
directly measures individual biomarkers’ roles in treatment effect
modification. The methodology, dubbed <em>uniCATE</em>, relies on
semiparametric theory to perform assumption-lean inference about this
parameter. We demonstrated that our procedure controls the rate of false
discoveries in high-dimensional randomized control trials, allowing for
the accurate identification of predictive biomarkers. This methodology
is implemented in the <code>uniCATE</code> package.</p>
</div>
<div class="section level2">
<h2 id="unicate-in-action">
<code>uniCATE</code> in Action<a class="anchor" aria-label="anchor" href="#unicate-in-action"></a>
</h2>
<p>This section provides a high-level overview of the statistical
methodology for various outcome types, and includes brief tutorials of
the package’s methods applied to simulated data.</p>
<div class="section level3">
<h3 id="continuous-outcomes">Continuous Outcomes<a class="anchor" aria-label="anchor" href="#continuous-outcomes"></a>
</h3>
<div class="section level4">
<h4 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h4>
<p>Suppose we perform a randomized control trial (RCT) where each
patient is represented by one of <span class="math inline">\(n\)</span>
independent and identically distributed (i.i.d.) copies of the full-data
random vector <span class="math inline">\(X_i = (W_i, A_i, Y_i^{(0)},
Y_i^{(1)})\)</span> distributed according <span class="math inline">\(P_X\)</span>, <span class="math inline">\(i = 1,
\ldots, n\)</span>. Here, <span class="math inline">\(W_i = (V_i,
B_i)\)</span> is a <span class="math inline">\((q+p)\)</span>-length
random vector of <span class="math inline">\(q\)</span> pre-treatment
covariates, <span class="math inline">\(V\)</span>, like location and
nationality, and <span class="math inline">\(p\)</span> pre-treatment
biomarkers, <span class="math inline">\(B\)</span>, such as gene
expression data, <span class="math inline">\(A\)</span> is a binary
random variable representing treatment assignment, and <span class="math inline">\(Y^{(1)}\)</span> and <span class="math inline">\(Y^{(0)}\)</span> are continuous random variables
corresponding to the potential outcomes of clinical interest under both
treatment and control conditions, respectively. Of course, we do not
have access to patients’ full-data random vector since we only get to
observe the outcomes associated with their treatment assignments. These
<span class="math inline">\(n\)</span> i.i.d. random observations are
represented by <span class="math inline">\(O_i = (W_i, A_i,
Y_i)\)</span> distributed according to the unknown data-generating
distribution <span class="math inline">\(P_0\)</span>. <span class="math inline">\(W_i\)</span> and <span class="math inline">\(A_i\)</span> are defined as before, and <span class="math inline">\(Y_i = Y_i^{(0)}(1-A_i) + Y^{(1)}_iA_i\)</span>.
Throughout the rest of the tutorial, we drop the index <span class="math inline">\(i\)</span> where possible to simplify
notation.</p>
</div>
<div class="section level4">
<h4 id="target-parameter">Target Parameter<a class="anchor" aria-label="anchor" href="#target-parameter"></a>
</h4>
<p>Ideally, we would like to estimate the full-data parameter <span class="math inline">\(\Psi(P_x) = (\Psi_1(P_X), \ldots,
\Psi_p(P_X))\)</span> corresponding to <span class="math inline">\(p\)</span>-length random vector whose elements are
defined as <span class="math display">\[
\Psi_j(P_X) =
\frac{\mathbb{E}_{P_X}\left[\left(Y^{(1)}-Y^{(0)}\right)B_j\right]}
{\mathbb{E}_{P_X}\left[B_j^2\right]}
\]</span> for <span class="math inline">\(j=1, \ldots, p\)</span> where
we assume that the biomarkers are centered at zero. Under the assumption
that the mean difference in potential outcomes is a linear function of
<span class="math inline">\(B_j\)</span>, <span class="math inline">\(\Psi(P_X)\)</span> is the vector of expected
simple linear regression coefficients produced by regressing the
difference in potential outcomes against each biomarker. While the true
relationship between the difference of potential outcomes and a
predictive biomarker is almost surely nonlinear, <span class="math inline">\(\Psi(P_X)\)</span> is a generally informative
target of inference. These parameters are reasonable indicators of all
but pathological relationships between biomarkers and potential outcome
differences.</p>
<p>Under conditions that are generally satisfied in the clinical trial
setting, we find that <span class="math inline">\(\Psi(P_X)\)</span> can
be estimated from realizations of the observed data-generating
distribution. Further, the estimator of this parameter implemented in
the <code><a href="../reference/unicate.html">unicate()</a></code> function is consistent and asymptotically
linear, permitting valid statistical inference in most RCT scenarios.
Details are provided in the manuscript.</p>
</div>
<div class="section level4">
<h4 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h4>
<p>We simulate some RCT data to demonstrate the application of
<code><a href="../reference/unicate.html">unicate()</a></code>. We refrain from generating a high-dimensional
vector of biomarkers for computational convenience.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">uniCATE</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># simulate n trial participants</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">200</span></span>
<span></span>
<span><span class="co"># simulate randomized control trial data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">514</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>    B1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, mean <span class="op">=</span> <span class="fl">2</span>, sd <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span>,</span>
<span>    B2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, mean <span class="op">=</span> <span class="op">-</span><span class="fl">2</span>, sd <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span>,</span>
<span>    B3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>    B4 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>    V1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">0.4</span><span class="op">)</span>,</span>
<span>    V2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>,</span>
<span>    A <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>    Y <span class="op">=</span> <span class="va">A</span> <span class="op">+</span> <span class="va">V1</span> <span class="op">-</span> <span class="va">V2</span> <span class="op">+</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">B1</span> <span class="op">*</span> <span class="va">A</span> <span class="op">+</span> <span class="va">B2</span> <span class="op">*</span> <span class="va">A</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># define the propensity scores</span></span>
<span><span class="va">propensity_score_ls</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"1"</span> <span class="op">=</span> <span class="fl">0.5</span>, <span class="st">"0"</span> <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># glimpse of data structure</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 8</span></span></span>
<span><span class="co">#&gt;      B1    B2      B3      B4    V1      V2     A      Y</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>  2.62 -<span style="color: #BB0000;">2.26</span>  0.088<span style="text-decoration: underline;">1</span>  0.044<span style="text-decoration: underline;">9</span>     1 -<span style="color: #BB0000;">0.081</span><span style="color: #BB0000; text-decoration: underline;">5</span>     1  5.07 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>  1.68 -<span style="color: #BB0000;">1.72</span> -<span style="color: #BB0000;">0.074</span><span style="color: #BB0000; text-decoration: underline;">6</span>  0.082<span style="text-decoration: underline;">8</span>     1  0.518      0  0.482</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>  2.23 -<span style="color: #BB0000;">2.12</span> -<span style="color: #BB0000;">0.043</span><span style="color: #BB0000; text-decoration: underline;">7</span>  0.031<span style="text-decoration: underline;">7</span>     1 -<span style="color: #BB0000;">0.737</span>      1  5.08 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>  2.20 -<span style="color: #BB0000;">2.08</span> -<span style="color: #BB0000;">0.094</span><span style="color: #BB0000; text-decoration: underline;">2</span>  0.096<span style="text-decoration: underline;">4</span>     1  0.534      1  3.79 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>  2.31 -<span style="color: #BB0000;">1.71</span> -<span style="color: #BB0000;">0.047</span><span style="color: #BB0000; text-decoration: underline;">7</span> -<span style="color: #BB0000;">0.070</span><span style="color: #BB0000; text-decoration: underline;">0</span>     1  0.648      0  0.352</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>  2.35 -<span style="color: #BB0000;">1.96</span> -<span style="color: #BB0000;">0.088</span><span style="color: #BB0000; text-decoration: underline;">8</span> -<span style="color: #BB0000;">0.103</span>      1  1.93       0 -<span style="color: #BB0000;">0.928</span></span></span></code></pre></div>
<p>This simulated trial is made up of 200 participants. Four
pre-treatment biomarkers and two pre-treatment covariates are generated
for each participant. Observations are then randomly assigned with equal
probability to either the treatment or the control condition. From the
definition of the outcome, it is clear that <code>B1</code> and
<code>B2</code> are predictive biomarkers. Finally, we define the
<code>propensity_score_ls</code>, a list indicating the probability that
any given patient is assigned to the treatment condition,
<code>"1"</code>, or the control condition, <code>"0"</code>. Note that
the treatment condition’s entry in this list always precedes the control
condition’s.</p>
<p>We now apply <code><a href="../reference/unicate.html">unicate()</a></code> to this data to recover the
variable importance measures of the biomarkers.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/unicate.html">unicate</a></span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  outcome <span class="op">=</span> <span class="st">"Y"</span>,</span>
<span>  treatment <span class="op">=</span> <span class="st">"A"</span>,</span>
<span>  covariates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"B1"</span>, <span class="st">"B2"</span>, <span class="st">"B3"</span>, <span class="st">"B4"</span>, <span class="st">"V1"</span>, <span class="st">"V2"</span><span class="op">)</span>,</span>
<span>  biomarkers <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"B1"</span>, <span class="st">"B2"</span>, <span class="st">"B3"</span>, <span class="st">"B4"</span><span class="op">)</span>,</span>
<span>  propensity_score_ls <span class="op">=</span> <span class="va">propensity_score_ls</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 7</span></span></span>
<span><span class="co">#&gt;   biomarker   coef     se      z   p_value p_value_bh p_value_holm</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> B1         2.00  0.065<span style="text-decoration: underline;">0</span> 30.9   5.30<span style="color: #949494;">e</span><span style="color: #BB0000;">-209</span>  2.12<span style="color: #949494;">e</span><span style="color: #BB0000;">-208</span>    2.12<span style="color: #949494;">e</span><span style="color: #BB0000;">-208</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> B2         1.03  0.168   6.13  9.03<span style="color: #949494;">e</span><span style="color: #BB0000;">- 10</span>  1.81<span style="color: #949494;">e</span><span style="color: #BB0000;">-  9</span>    2.71<span style="color: #949494;">e</span><span style="color: #BB0000;">-  9</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> B4         0.590 0.388   1.52  1.28<span style="color: #949494;">e</span><span style="color: #BB0000;">-  1</span>  1.70<span style="color: #949494;">e</span><span style="color: #BB0000;">-  1</span>    2.56<span style="color: #949494;">e</span><span style="color: #BB0000;">-  1</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> B3        -<span style="color: #BB0000;">0.152</span> 0.348  -<span style="color: #BB0000;">0.436</span> 6.63<span style="color: #949494;">e</span><span style="color: #BB0000;">-  1</span>  6.63<span style="color: #949494;">e</span><span style="color: #BB0000;">-  1</span>    6.63<span style="color: #949494;">e</span><span style="color: #BB0000;">-  1</span></span></span></code></pre></div>
<p>The output is a table summarizing the variable importance parameter
estimates of each biomarker (<code>coef</code>), the estimators’
standard errors (<code>se</code>), the two-sided hypothesis tests’
Z-scores (<code>z</code>), and the tests’ (adjusted) p-values
(<code>p_value</code>, <code>p_value_bh</code>, and
<code>p_value_holm</code>).</p>
<p>As expected, <code>B1</code> modifies the treatment effect the most,
followed by <code>B2</code>. Both of their variable importance measures
are found to be significantly different from zero (using a 5%
significance threshold) at the nominal level and after adjusting for
multiple testing. As patients’ <code>B1</code> and <code>B2</code>
values marginally increase, so too does their benefit from being
assigned to the treatment condition over the control condition. The
remaining biomarkers’ variable importance parameters are not
significantly different from zero at the same level of significance.
There is insufficient evidence to categorize them as predictive.</p>
</div>
</div>
<div class="section level3">
<h3 id="binary-outcomes">Binary Outcomes<a class="anchor" aria-label="anchor" href="#binary-outcomes"></a>
</h3>
<div class="section level4">
<h4 id="setup-1">Setup<a class="anchor" aria-label="anchor" href="#setup-1"></a>
</h4>
<p>The assumed full-data and observed data-generating processes are
identical to those of the continuous outcome save that <span class="math inline">\(Y^{(0)}, Y^{(1)}\)</span> and <span class="math inline">\(Y\)</span> are binary random variables.</p>
</div>
<div class="section level4">
<h4 id="target-parameter-1">Target Parameter<a class="anchor" aria-label="anchor" href="#target-parameter-1"></a>
</h4>
<p>The full-data parameter of interest looks slightly different from the
continuous outcome scenario to reflect the use of a binary outcome. We
target <span class="math inline">\(\Psi(P_X) = (\Psi_1(P_X), \ldots,
\Psi_p(P_X))\)</span> where <span class="math display">\[
\Psi_j(P_X) =
\frac{\mathbb{E}_{P_X}\left[\left(\mathbb{P}_{P_X}(Y^{(1)} =1| W)
  - \mathbb{P}_{P_X}(Y^{(0)} = 1| W)\right)B_j\right]}
{\mathbb{E}_{P_X}\left[B_j^2\right]}
\]</span> for centered biomarkers indexed by <span class="math inline">\(j = 1, \ldots, p\)</span>. Assuming a linear
relationship between the difference of the potential outcomes’
probability of success and the covariates, this variable importance
parameter consists of the simple linear regression coefficients of the
difference in the conditional potential outcome success probabilities
regressed on each biomarker. While the true relationship between
potential outcome probabilities and covariates is again unlikely to be
linear, this parameter is telling of biomarkers’ predictive capacities.
Biomarkers with the largest absolute values will correspond to those
that meaningfully modify the treatment effect. In truth, this is the
same variable importance parameter as the for continuous outcomes, but
written in a more intuitive form.</p>
<p>As in the continuous case, this parameter can generally be estimated
from the observed RCT data under non-stringent assumptions about the
data-generating process. Inference is in fact based on the same
estimator used for continuous outcomes, and so we again use
<code><a href="../reference/unicate.html">unicate()</a></code> to learn about the biomarkers’ marginal
importance in regards to binary treatment effect modification. For
details, please review the manuscript. We do not provide an example
since it would be nearly identical to that given in the previous
subsection.</p>
</div>
</div>
<div class="section level3">
<h3 id="survival-outcomes">Survival Outcomes<a class="anchor" aria-label="anchor" href="#survival-outcomes"></a>
</h3>
<div class="section level4">
<h4 id="setup-2">Setup<a class="anchor" aria-label="anchor" href="#setup-2"></a>
</h4>
<p>We perform an RCT where the outcome of interest is a right-censored
time-to-event outcome. We consider <span class="math inline">\(n\)</span> i.i.d. copies of the full-data random
vector <span class="math inline">\(X = (W, A, T^{(0)}, C^{(0)}, T^{(1)},
C^{(1)})\)</span> distributed according to <span class="math inline">\(P_X\)</span> where <span class="math inline">\(W\)</span> and <span class="math inline">\(A\)</span> are defined as in the continuous
outcome case. <span class="math inline">\(T^{(0)}\)</span> and <span class="math inline">\(T^{(1)}\)</span> correspond to the event times
under control and treatment conditions, and <span class="math inline">\(C^{(0)}\)</span> and <span class="math inline">\(C^{(1)}\)</span> correspond to the censoring times
under control and treatment conditions. As before, the full-data random
vectors are never observed; instead, we observe <span class="math inline">\(n\)</span> i.i.d. copies of <span class="math inline">\(O = (W, A, \Delta, \tilde{T})\)</span> distributed
according to <span class="math inline">\(P_0\)</span>. Here, <span class="math inline">\(\Delta\)</span> is a censoring indicator and <span class="math inline">\(\tilde{T}=(1-A)\;\text{min}(T^{(0)},
C^{(0)})+A\;\text{min}(T^{(1)}, C^{(1)})\)</span> is the last
measurement time.</p>
</div>
<div class="section level4">
<h4 id="target-parameter-2">Target Parameter<a class="anchor" aria-label="anchor" href="#target-parameter-2"></a>
</h4>
<p>In this scenario, our variance important parameter is a function of
the treatment effect on survival at time <span class="math inline">\(t_0\)</span>. Recall that survival at time <span class="math inline">\(t_0\)</span> in the full-data is defined as <span class="math inline">\(S^{(A)}(t_0|W) = \mathbb{P}_{P_X}(T^{(A)} &gt; t_0
| W)\)</span>. The target parameter is then represented by <span class="math inline">\(\Psi(P_X; t_0) = (\Psi_1(P_X; t_0), \ldots,
\Psi_p(P_X; t_0))\)</span> where <span class="math display">\[
\Psi_j(P_X;t_0) =
\frac{\mathbb{E}_{P_X}\left[\left(S^{(1)}(t_0|W)-S^{(0)}(t_0|W)\right)B_j\right]}
{\mathbb{E}_{P_X}\left[B_j^2\right]}
\]</span> for centered biomarkers indexed by <span class="math inline">\(j = 1, \ldots, p\)</span>. Similarly to the binary
outcome scenario, this variable importance measure assumes a linear
relationship between the contrast of survival outcomes at time <span class="math inline">\(t_0\)</span> and each biomarker, and consists of
the simple linear regression coefficients of this contrast regressed on
each biomarker. Again, while the true relationship between the
difference in survival probabilities and biomarkers is unlikely to be
linear, it provides a metric by which to evaluate biomarkers’ abilities
to modify treatment effects on the absolute scale.</p>
<p>As with the other variable importance metrics, this parameter can
often be estimated from the observed data in a RCT. The estimator of
this parameter is implemented in the <code><a href="../reference/sunicate.html">sunicate()</a></code> function.
Under the assumption that the censoring mechanism is consistently
estimated by our procedure, the <code><a href="../reference/sunicate.html">sunicate()</a></code> estimator is
consistent and asymptotically linear. Valid statistical inference about
the strength of biomarkers’ treatment effect modification is therefore
made possible with survival outcomes.</p>
</div>
<div class="section level4">
<h4 id="example-1">Example<a class="anchor" aria-label="anchor" href="#example-1"></a>
</h4>
<p>We now simulate some RCT data with a right-censored time to event
outcome. Again, we consider a low-dimensional biomarker vector for
computational efficiency.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># simulate n trial participants</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">200</span></span>
<span></span>
<span><span class="co"># generate a tibble of baseline characteristics</span></span>
<span><span class="va">baseline_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  A <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  V1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>,</span>
<span>  V2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>,</span>
<span>  B1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>,</span>
<span>  B2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># simulate event and censoring times</span></span>
<span><span class="co"># define hazard functions</span></span>
<span><span class="va">cond_surv_hazard</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>, <span class="va">a</span>, <span class="va">b1</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="op">(</span><span class="va">t</span> <span class="op">&lt;</span> <span class="fl">9</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span> <span class="op">(</span><span class="op">-</span><span class="fl">2</span> <span class="op">-</span> <span class="fl">3</span> <span class="op">*</span> <span class="va">a</span> <span class="op">*</span> <span class="va">b1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="op">(</span><span class="va">t</span> <span class="op">==</span> <span class="fl">9</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># generate the event indicators for t = 1 to 9</span></span>
<span><span class="va">event_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>,</span>
<span>  <span class="kw">function</span><span class="op">(</span><span class="va">obs</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">event_time</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">t</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">prob</span> <span class="op">&lt;-</span> <span class="fu">cond_surv_hazard</span><span class="op">(</span><span class="va">t</span>, <span class="va">baseline_data</span><span class="op">$</span><span class="va">A</span><span class="op">[</span><span class="va">obs</span><span class="op">]</span>, <span class="va">baseline_data</span><span class="op">$</span><span class="va">B1</span><span class="op">[</span><span class="va">obs</span><span class="op">]</span><span class="op">)</span></span>
<span>      <span class="va">status</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="va">prob</span><span class="op">)</span></span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="va">status</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">event_time</span> <span class="op">&lt;-</span> <span class="va">t</span></span>
<span>        <span class="kw">break</span></span>
<span>      <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">event_time</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># generate the censoring events for t = 1 to 9</span></span>
<span><span class="va">censor_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>,</span>
<span>  <span class="kw">function</span><span class="op">(</span><span class="va">obs</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">censor_time</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">t</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">status</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0.15</span><span class="op">)</span></span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="va">status</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">censor_time</span> <span class="op">&lt;-</span> <span class="va">t</span></span>
<span>        <span class="kw">break</span></span>
<span>      <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">censor_time</span><span class="op">)</span><span class="op">)</span> <span class="va">censor_time</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">censor_time</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># assemble the event and censoring times into a tibble</span></span>
<span><span class="va">status_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>    <span class="st">"event_time"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">event_time</span><span class="op">)</span>,</span>
<span>    <span class="st">"censor_time"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">censor_time</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/transmute.html" class="external-link">transmute</a></span><span class="op">(</span></span>
<span>      time <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">censor_time</span> <span class="op">&lt;</span> <span class="va">event_time</span>, <span class="va">censor_time</span>, <span class="va">event_time</span><span class="op">)</span>,</span>
<span>      censor <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">censor_time</span> <span class="op">&lt;</span> <span class="va">event_time</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>      event <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">censor_time</span> <span class="op">&gt;=</span> <span class="va">event_time</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="co"># assemble the complete RCT data</span></span>
<span><span class="co"># uniCATE functions can handle treatment indicators as factor variables, too</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">baseline_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    A <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">A</span> <span class="op">==</span> <span class="fl">1</span>, <span class="st">"treatment"</span>, <span class="st">"control"</span><span class="op">)</span>,</span>
<span>    A <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">A</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"treatment"</span>, <span class="st">"control"</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span><span class="va">status_df</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># glimpse of data structure</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 8</span></span></span>
<span><span class="co">#&gt;   A              V1      V2     B1     B2  time censor event</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> treatment  0.786   0.509   0.735  0.950     9      0     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> control   -<span style="color: #BB0000;">1.07</span>   -<span style="color: #BB0000;">1.69</span>   -<span style="color: #BB0000;">0.386</span>  0.555     2      0     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> control   -<span style="color: #BB0000;">0.062</span><span style="color: #BB0000; text-decoration: underline;">7</span> -<span style="color: #BB0000;">2.07</span>    1.43  -<span style="color: #BB0000;">0.169</span>     1      1     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> control   -<span style="color: #BB0000;">0.979</span>   0.732   0.475  0.967     1      0     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> control    0.267  -<span style="color: #BB0000;">0.052</span><span style="color: #BB0000; text-decoration: underline;">9</span> -<span style="color: #BB0000;">0.171</span> -<span style="color: #BB0000;">0.252</span>     9      0     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> control    0.212  -<span style="color: #BB0000;">0.208</span>   1.30   0.162     1      1     0</span></span></code></pre></div>
<p>The data simulated in the previous chunk relies on an uninformative
censoring mechanism and a event mechanism that is a function of the
interaction between the treatment assignment <span class="math inline">\(A\)</span> and the biomarker <span class="math inline">\(B1\)</span>. These event and censoring times occur
at one of 9 discrete relative follow-up times for all 500 study
participants. Take special notice of the <code>censor</code> and
<code>event</code> columns that describe the relative time measurement
in <code>time</code>: the former is a binary indicator of censoring, and
the later of event. Finally, note that <code><a href="../reference/sunicate.html">sunicate()</a></code> (and
<code><a href="../reference/unicate.html">unicate()</a></code>) accept treatment indicators that are factor
variables, like <code>A</code>.</p>
<p>We now assess the predictive importance of biomarkers with respect to
survival at time <span class="math inline">\(t_0=6\)</span> by setting
the <code>time_cutoff</code> argument to <code>6</code>. Note when the
<code>time_cutoff</code> argument is not specified, <span class="math inline">\(t_0\)</span> defaults to the median relative time
in the <code>data</code> argument.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/sunicate.html">sunicate</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  event <span class="op">=</span> <span class="st">"event"</span>,</span>
<span>  censor <span class="op">=</span> <span class="st">"censor"</span>,</span>
<span>  relative_time <span class="op">=</span> <span class="st">"time"</span>,</span>
<span>  treatment <span class="op">=</span> <span class="st">"A"</span>,</span>
<span>  covariates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"V1"</span>, <span class="st">"V2"</span>, <span class="st">"B1"</span>, <span class="st">"B2"</span><span class="op">)</span>,</span>
<span>  biomarkers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"B1"</span>, <span class="st">"B2"</span><span class="op">)</span>,</span>
<span>  time_cutoff <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  propensity_score_ls <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"treatment"</span> <span class="op">=</span> <span class="fl">0.5</span>, <span class="st">"control"</span> <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Returning more (or less) than 1 row per `summarise()` group was deprecated in</span></span>
<span><span class="co">#&gt; dplyr 1.1.0.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Please use `reframe()` instead.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> When switching from `summarise()` to `reframe()`, remember that `reframe()`</span></span>
<span><span class="co">#&gt;   always returns an ungrouped data frame and adjust accordingly.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> The deprecated feature was likely used in the <span style="color: #0000BB;">uniCATE</span> package.</span></span>
<span><span class="co">#&gt;   Please report the issue to the authors.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 7</span></span></span>
<span><span class="co">#&gt;   biomarker    coef     se      z   p_value p_value_bh p_value_holm</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> B1         0.343  0.083<span style="text-decoration: underline;">1</span>  4.13  0.000<span style="text-decoration: underline;">036</span>2  0.000<span style="text-decoration: underline;">072</span>5    0.000<span style="text-decoration: underline;">072</span>5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> B2        -<span style="color: #BB0000;">0.041</span><span style="color: #BB0000; text-decoration: underline;">4</span> 0.101  -<span style="color: #BB0000;">0.411</span> 0.681      0.681        0.681</span></span></code></pre></div>
<p><code><a href="../reference/sunicate.html">sunicate()</a></code> produces a table identical to that generated
by <code><a href="../reference/unicate.html">unicate()</a></code>. It provides very strong evidence that
<code>B1</code> is a treatment effect modifier with a non-zero variance
important parameter. <code>B2</code>, on the other hand, does not appear
to be a predictive biomarker since we fail to reject its associated
test. These results capture the ground truth of our data-generating
process.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="additional-features">Additional Features<a class="anchor" aria-label="anchor" href="#additional-features"></a>
</h2>
<p><code><a href="../reference/unicate.html">unicate()</a></code> and <code><a href="../reference/sunicate.html">sunicate()</a></code> rely on sensible
default arguments to simplify their usage. However, advanced users may
be interested changing these defaults. In particular, parallelization
routines relying on the <a href="https://cran.r-project.org/package=future" class="external-link"><code>future</code></a>
suite might be employed when analyzing large data sets by setting the
<code>parallel</code> argument to <code>TRUE</code>. The number of folds
used during the K-fold cross-validation routines might be changed
through the <code>v_folds</code> argument. Finally, the semiparametric
estimators’ nuisance parameters are learned using pre-packaged <a href="https://tlverse.org/sl3/" class="external-link"><code>sl3</code></a> Super Learners.
Custom Super Learners can be employed in their place.</p>
</div>
<div class="section level2">
<h2 id="session-information">Session Information<a class="anchor" aria-label="anchor" href="#session-information"></a>
</h2>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.2.2 (2022-10-31)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 22.04.1 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3</span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span></span>
<span><span class="co">#&gt;  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span></span>
<span><span class="co">#&gt;  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span></span>
<span><span class="co">#&gt;  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span></span>
<span><span class="co">#&gt; [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt; [1] dplyr_1.1.0   uniCATE_0.4.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;   [1] nlme_3.1-162         matrixStats_0.63.0   fs_1.6.1            </span></span>
<span><span class="co">#&gt;   [4] lubridate_1.9.2      progress_1.2.2       rprojroot_2.0.3     </span></span>
<span><span class="co">#&gt;   [7] tools_4.2.2          backports_1.4.1      bslib_0.4.2         </span></span>
<span><span class="co">#&gt;  [10] utf8_1.2.3           R6_2.5.1             rpart_4.1.19        </span></span>
<span><span class="co">#&gt;  [13] colorspace_2.1-0     nnet_7.3-18          withr_2.5.0         </span></span>
<span><span class="co">#&gt;  [16] tidyselect_1.2.0     prettyunits_1.1.1    compiler_4.2.2      </span></span>
<span><span class="co">#&gt;  [19] glmnet_4.1-6         textshaping_0.3.6    cli_3.6.0           </span></span>
<span><span class="co">#&gt;  [22] desc_1.4.2           sass_0.4.5           scales_1.2.1        </span></span>
<span><span class="co">#&gt;  [25] checkmate_2.1.0      randomForest_4.7-1.1 pkgdown_2.0.7       </span></span>
<span><span class="co">#&gt;  [28] systemfonts_1.0.4    stringr_1.5.0        digest_0.6.31       </span></span>
<span><span class="co">#&gt;  [31] rmarkdown_2.20       R.utils_2.12.2       pkgconfig_2.0.3     </span></span>
<span><span class="co">#&gt;  [34] htmltools_0.5.4      parallelly_1.34.0    fastmap_1.1.0       </span></span>
<span><span class="co">#&gt;  [37] htmlwidgets_1.6.1    rlang_1.0.6          BBmisc_1.13         </span></span>
<span><span class="co">#&gt;  [40] shape_1.4.6          visNetwork_2.1.2     jquerylib_0.1.4     </span></span>
<span><span class="co">#&gt;  [43] generics_0.1.3       jsonlite_1.8.4       ModelMetrics_1.2.2.2</span></span>
<span><span class="co">#&gt;  [46] R.oo_1.25.0          magrittr_2.0.3       delayed_0.4.0       </span></span>
<span><span class="co">#&gt;  [49] Matrix_1.5-3         Rcpp_1.0.10          munsell_0.5.0       </span></span>
<span><span class="co">#&gt;  [52] fansi_1.0.4          abind_1.4-5          lifecycle_1.0.3     </span></span>
<span><span class="co">#&gt;  [55] R.methodsS3_1.8.2    pROC_1.18.0          stringi_1.7.12      </span></span>
<span><span class="co">#&gt;  [58] yaml_2.3.7           MASS_7.3-58.2        plyr_1.8.8          </span></span>
<span><span class="co">#&gt;  [61] recipes_1.0.5        grid_4.2.2           parallel_4.2.2      </span></span>
<span><span class="co">#&gt;  [64] listenv_0.9.0        crayon_1.5.2         lattice_0.20-45     </span></span>
<span><span class="co">#&gt;  [67] splines_4.2.2        hms_1.1.2            knitr_1.42          </span></span>
<span><span class="co">#&gt;  [70] pillar_1.8.1         igraph_1.4.0         uuid_1.1-0          </span></span>
<span><span class="co">#&gt;  [73] origami_1.0.7        stats4_4.2.2         reshape2_1.4.4      </span></span>
<span><span class="co">#&gt;  [76] future.apply_1.10.0  codetools_0.2-19     glue_1.6.2          </span></span>
<span><span class="co">#&gt;  [79] evaluate_0.20        data.table_1.14.8    vctrs_0.5.2         </span></span>
<span><span class="co">#&gt;  [82] Rdpack_2.4           foreach_1.5.2        gtable_0.3.1        </span></span>
<span><span class="co">#&gt;  [85] purrr_1.0.1          rstackdeque_1.1.1    future_1.31.0       </span></span>
<span><span class="co">#&gt;  [88] assertthat_0.2.1     cachem_1.0.6         ggplot2_3.4.1       </span></span>
<span><span class="co">#&gt;  [91] xfun_0.37            sl3_1.4.4            gower_1.0.1         </span></span>
<span><span class="co">#&gt;  [94] prodlim_2019.11.13   rbibutils_2.2.13     ragg_1.2.5          </span></span>
<span><span class="co">#&gt;  [97] class_7.3-21         survival_3.5-3       timeDate_4022.108   </span></span>
<span><span class="co">#&gt; [100] tibble_3.1.8         iterators_1.0.14     memoise_2.0.1       </span></span>
<span><span class="co">#&gt; [103] hardhat_1.2.0        lava_1.7.1           timechange_0.2.0    </span></span>
<span><span class="co">#&gt; [106] globals_0.16.2       imputeMissings_0.0.3 ellipsis_0.3.2      </span></span>
<span><span class="co">#&gt; [109] caret_6.0-93         ROCR_1.0-11          ipred_0.9-13</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-chen2017" class="csl-entry">
Chen, Shuai, Lu Tian, Tianxi Cai, and Menggang Yu. 2017. <span>“A
General Statistical Framework for Subgroup Identification and
Comparative Treatment Scoring.”</span> <em>Biometrics</em> 73 (4):
1199–209. https://doi.org/<a href="https://doi.org/10.1111/biom.12676" class="external-link">https://doi.org/10.1111/biom.12676</a>.
</div>
<div id="ref-tian2014" class="csl-entry">
Tian, Lu, Ash A. Alizadeh, Andrew J. Gentles, and Robert Tibshirani.
2014. <span>“A Simple Method for Estimating Interactions Between a
Treatment and a Large Number of Covariates.”</span> <em>Journal of the
American Statistical Association</em> 109 (508): 1517–32. <a href="https://doi.org/10.1080/01621459.2014.951443" class="external-link">https://doi.org/10.1080/01621459.2014.951443</a>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Philippe Boileau.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
